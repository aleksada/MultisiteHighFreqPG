"0","ut.fun <- function(data,sep){"
"0","    binaryrain <- data > 0"
"0","    NT <- length(binaryrain)"
"0","    t <- (1:NT)-1"
"0","    ht <- floor(94.5 + sep*t/(2 * 60 * 24))"
"0","    H <- 10"
"0","    sint<- matrix(0, length(t), H)"
"0","    cost<- matrix(0, length(t), H)"
"0","    save.aic <- rep(0,H)"
"0","    for(i in 1:H){"
"0","    sint[,i] <- sin(2 * i * pi * ht/365)"
"0","    cost[,i] <- cos(2 * i * pi * ht/365)"
"0","    season.fit <- glm(binaryrain ~ sint[,1:i] + cost[,1:i],family = ""binomial"")"
"0","    save.aic[i] <- AIC(season.fit)"
"0","}"
"0","H.best <- which(save.aic == min(save.aic))"
"0","season.fit.best <- glm(binaryrain ~ sint[,1:H.best] + cost[,1:H.best], family=""binomial"")"
"0","fitted <- season.fit.best$fitted"
"0","ut <- quantile(data, 1 - fitted)"
"0","return(ut)"
"0","}"
